<script nonce="<%= locals.nonce %>">
    const socket = io({
        auth: {
            type: 0,
            user: "<%= locals.name %>",
            room: "<%= locals.room %>"
        }
    });

    document.getElementById("start").addEventListener("click", function(){
        socket.emit("start");
    });

    document.getElementById("skip").addEventListener("click", function(){
        socket.emit("skip");
    });

    document.getElementById("finish").addEventListener("click", function(){
        socket.emit("finish");
    });

    document.querySelectorAll("page#lobby div.colors div").forEach(function(e, i){
        e.addEventListener("click", function(){
            socket.emit("update", "skin", i);
        });
    });

    socket.on("owner", function(){
        document.getElementById("start").setAttribute("active", "1");
        document.getElementById("skip").setAttribute("active", "1");
    });

    socket.on("money", function(money){
        document.getElementById("money").innerText = money;
    });

    socket.on("startRound", function(){
        setActive("dashboard");
    });

    socket.on("cutscene", function(){
        setActive("waiting");
    });

    socket.on("dc", () => window.location = "/join");

    function setActive(id){
        document.querySelectorAll("page").forEach((page) => page.setAttribute("active", "0"));
        document.getElementById(id).setAttribute("active", "1");
    }
</script>