<script nonce="<%= locals.nonce %>">
    var ready = false;

    const socket = io({
        auth: {
            type: 0,
            user: "<%= locals.name %>",
            room: "<%= locals.room %>"
        }
    });

    document.querySelector("page#lobby button#ready").addEventListener("click", function(){
        ready = Boolean(1 - ready);
        document.querySelector("page#lobby button#ready").innerText = ["ready", "not ready"][+ready];
        socket.emit("update", "ready", ready);
    });

    document.querySelectorAll("page#lobby div.colors div").forEach(function(e, i){
        console.log(e)
        e.addEventListener("click", function(){
            socket.emit("update", "skin", i);
        });
    });

    socket.on("owner", function(){
        var button = document.createElement("button");
        button.innerText = "start game";
        document.body.append(button);
    });

    socket.on("dc", () => window.location = "/join");
</script>